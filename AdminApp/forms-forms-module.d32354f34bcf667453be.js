/*! For license information please see forms-forms-module.d32354f34bcf667453be.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([["forms-forms-module"],{2517:function(e,t,n){"use strict";n.r(t),n.d(t,"SfFormsModule",(function(){return v}));var o=n(314),i=n(261),r=n(414),s=n(2518),a=n(1573),l=n(2526),c=n(2527),f=n(2519),u=n(2528),m=n(2520),p=n(2525),d=n(2522),C=n(2524),E=n(2530),h=n(260),T=n(1215),g=n(1591),F=n(2529),S=n(229),I=[{path:"integrated",children:[{path:"**",component:E.FormsEditIntegratedComponent}]},{path:"rules",component:s.FormRulesListComponent,children:[{path:"confirm/:name",component:T.ModalWindowComponent,outlet:"dialog"}],resolve:{metaStore:g.MetadataStoreResolver}}],v=function(){function e(){}return e.ɵfac=function(t){return new(t||e)},e.ɵmod=S["ɵɵdefineNgModule"]({type:e}),e.ɵinj=S["ɵɵdefineInjector"]({providers:[f.FormsService,d.FormFieldTypesParserService],imports:[[h.RouterModule.forChild(I),r.FieldsModule,a.SharedModule,o.FormsModule,i.CommonModule],h.RouterModule]}),e}();S["ɵɵsetNgModuleScope"](v,{declarations:[s.FormRulesListComponent,l.ConditionColumnComponent,c.ActionColumnComponent,m.FormRuleCreateComponent,p.ConditionCreateCompositeComponent,C.ActionCreateCompositeComponent,E.FormsEditIntegratedComponent,l.GetConditionFieldTitlePipe,l.GetConditionOperatorLabelPipe,l.GetConditionFieldValuePipe,l.GetRuleOperatorLabelPipe,u.FormActionColumnDirective,F.TrimTextPipe],imports:[h.RouterModule,r.FieldsModule,a.SharedModule,o.FormsModule,i.CommonModule],exports:[h.RouterModule]})},2518:function(e,t,n){"use strict";n.r(t),n.d(t,"FormRulesListComponent",(function(){return W}));var o=n(259),i=n(229),r=n(1172),s=n(304),a=n(2519),l=n(1533),c=n(246),f=n(1117),u=n(2520),m=n(260),p=n(2521),d=n(268),C=n(371),E=n(256),h=n(245),T=n(1138),g=n(131),F=n(1062),S=n(1137),I=n(1151),v=n(11),D=n(354),_=n(261),O=n(1574),R=n(1575),A=n(2526),y=n(2527),P=["navigationMenuTemplate"];function N(e,t){1&e&&(i["ɵɵelementStart"](0,"h3",7),i["ɵɵtext"](1,"Form rules"),i["ɵɵelementEnd"]())}function x(e,t){1&e&&(i["ɵɵelementStart"](0,"p",18),i["ɵɵtext"](1,"No rules have been created yet"),i["ɵɵelementEnd"]())}function w(e,t){1&e&&(i["ɵɵelementStart"](0,"p",18),i["ɵɵtext"](1,"You cannot create rules for an empty form"),i["ɵɵelementEnd"]())}function M(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"sf-button",19),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"](3).createRule(null)})),i["ɵɵtext"](1,"Create a rule"),i["ɵɵelementEnd"]()}}function L(e,t){if(1&e&&(i["ɵɵelementStart"](0,"div",10),i["ɵɵelementStart"](1,"div",11),i["ɵɵelementStart"](2,"h1",12),i["ɵɵtext"](3),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementStart"](4,"div",13),i["ɵɵelement"](5,"sf-icon",14),i["ɵɵtemplate"](6,x,2,0,"p",15),i["ɵɵtemplate"](7,w,2,0,"p",15),i["ɵɵelementEnd"](),i["ɵɵelementStart"](8,"div",16),i["ɵɵtemplate"](9,M,2,0,"sf-button",17),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]()),2&e){var n=i["ɵɵnextContext"](2);i["ɵɵadvance"](3),i["ɵɵtextInterpolate"](n.formDefinition.Title),i["ɵɵadvance"](3),i["ɵɵproperty"]("ngIf",n.hasFields),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",!n.hasFields),i["ɵɵadvance"](2),i["ɵɵproperty"]("ngIf",n.hasFields)}}function b(e,t){1&e&&(i["ɵɵelementStart"](0,"b"),i["ɵɵtext"](1,"IF"),i["ɵɵelementEnd"]())}function V(e,t){if(1&e&&i["ɵɵelement"](0,"sf-condition-column",30),2&e){var n=t.context,o=i["ɵɵnextContext"](3);i["ɵɵproperty"]("formRuleConditions",n.data.Conditions)("formRuleOperator",n.data.Operator)("formDefinition",o.formDefinition)}}function k(e,t){1&e&&(i["ɵɵelementStart"](0,"b"),i["ɵɵtext"](1,"THEN"),i["ɵɵelementEnd"]())}function G(e,t){if(1&e&&i["ɵɵelement"](0,"sf-action-column",31),2&e){var n=t.context,o=i["ɵɵnextContext"](3);i["ɵɵproperty"]("formRuleActions",n.data.Actions)("formDefinition",o.formDefinition)}}var Y=function(e){return{"-sf-disabled":e}};function U(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"sf-icon",32),i["ɵɵlistener"]("click",(function(){i["ɵɵrestoreView"](n);var e=t.context;return i["ɵɵnextContext"](3).deleteRule(e)})),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"](3);i["ɵɵproperty"]("ngClass",i["ɵɵpureFunction1"](1,Y,!o.canUpdate))}}function H(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"div",20),i["ɵɵelementStart"](1,"div",11),i["ɵɵelementStart"](2,"h1",12),i["ɵɵtext"](3),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementStart"](4,"div",21),i["ɵɵelementStart"](5,"sf-button",22),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"](2).createRule(null)})),i["ɵɵtext"](6,"Create a rule"),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementStart"](7,"sf-notification",23),i["ɵɵtext"](8," Rules will be active on the site after you publish the form. "),i["ɵɵelementEnd"](),i["ɵɵelementStart"](9,"sf-list",24),i["ɵɵlistener"]("itemSelectionChanged",(function(e){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"](2).createRule(e)})),i["ɵɵtemplate"](10,b,2,0,"ng-template",25),i["ɵɵtemplate"](11,V,1,3,"ng-template",26),i["ɵɵtemplate"](12,k,2,0,"ng-template",27),i["ɵɵtemplate"](13,G,1,2,"ng-template",28),i["ɵɵtemplate"](14,U,1,3,"ng-template",29),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"](2);i["ɵɵadvance"](3),i["ɵɵtextInterpolate"](o.formDefinition.Title),i["ɵɵadvance"](6),i["ɵɵproperty"]("itemsState",o.stateWrapper)("shouldHideHeader",o.shouldHideHeader)("treeConfig",o.treeConfig)("ignoreLoaderDelay",!0)}}function j(e,t){if(1&e&&(i["ɵɵelementContainerStart"](0),i["ɵɵtemplate"](1,L,10,4,"div",8),i["ɵɵtemplate"](2,H,15,5,"ng-template",null,9,i["ɵɵtemplateRefExtractor"]),i["ɵɵelementContainerEnd"]()),2&e){var n=i["ɵɵreference"](3),o=i["ɵɵnextContext"]();i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",!o.stateWrapper.hasItems)("ngIfElse",n)}}function B(e,t){1&e&&(i["ɵɵelementStart"](0,"div",35),i["ɵɵelementStart"](1,"div",36),i["ɵɵelement"](2,"sf-loader",37),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]())}var X=function(){return[0,0,0,0,0,0,0,0,0,0]};function K(e,t){1&e&&(i["ɵɵelementStart"](0,"div",33),i["ɵɵtemplate"](1,B,3,0,"div",34),i["ɵɵelementEnd"]()),2&e&&(i["ɵɵadvance"](1),i["ɵɵproperty"]("ngForOf",i["ɵɵpureFunction0"](1,X)))}var W=function(e){function t(t,n,o,i,s,a,l){var c=e.call(this)||this;return c.formsService=t,c.metadataStore=n,c.modalService=o,c.route=i,c.router=s,c.document=a,c.siteData=l,c.shouldHideHeader=!0,c.stateWrapper=r.StateWrapper.empty(),c.canUpdate=!0,c.isInitialRulesLoadComplete=!1,c.hasFields=!1,c}return Object(o.__extends)(t,e),t.prototype.ngOnInit=function(){var e=this;this.toggleEditFormControlCssClass(),this.route.queryParamMap.pipe(Object(g.flatMap)((function(t){return e.formId=t.get("id"),e.culture=t.get("culture")||c.stringConstants.EMPTY_STRING,e.siteData.getValue()})),Object(g.flatMap)((function(t){return e.culture=e.culture||t.DefaultContentCulture,e.formsService.getFormDefinition(e.formId,e.culture)})),Object(F.toLoadingState)(),Object(F.delayEmission)(S.MINIMUM_LOADER_TIME)).subscribe((function(t){if(!t.isLoading)try{var n=t.content;e.formDefinition=Object(h.cloneObject)(n.data),e.formDefinition.Rules=e.getFormRules(),e.formDefinition.Culture=e.culture,e.propagateRules(!1),e.hasFields=e.formDefinition.Fields&&e.formDefinition.Fields.length>0,e.isInitialRulesLoadComplete=!0}catch(t){e.handleFormRuleFetchError(t)}}),(function(t){e.handleFormRuleFetchError(t)})),this.navbarConfiguration={mode:l.NavbarModes.OneColumn,leftNavbarButtonData:{show:!0,look:"toggle",icon:"angle-left",iconLook:"size-2xl",mode:l.LeftNavbarButtonMode.Back,title:p.FormsConstants.BACK_TO_FORMS},isScrollEnabled:!1,look:c.stringConstants.EMPTY_STRING,templates:[this.navigationMenuTemplate]},this.treeConfig={noSelection:!0}},t.prototype.ngOnDestroy=function(){this.toggleEditFormControlCssClass(!1)},t.prototype.createRule=function(e){var t=this,n=e?e.data:null,o=e?this.stateWrapper.dataItems.indexOf(e):-1,i=e?Object(h.cloneObject)(n):null,r={type:u.FormRuleCreateComponent,afterComponentInit:function(n){n.title=e?p.FormsConstants.EDIT_A_RULE:p.FormsConstants.CREATE_A_RULE,n.formDefinition=t.formDefinition,n.formRule=i}},s=[new f.ConfirmButton(p.FormsConstants.CREATE_THIS_RULE,(function(e){return t.saveFormRulehandler(e,o)})),new f.CancelButton(p.FormsConstants.CANCEL)];e&&(s=[new f.ConfirmButton(p.FormsConstants.SAVE_THIS_RULE,(function(e){return t.saveFormRulehandler(e,o)})),new f.CancelButton(p.FormsConstants.CANCEL)]);var a=new f.DialogData(r,(function(e){}),s,null);this.modalService.setMapping(a,p.FormsConstants.ROUTES.CREATE_FORM_RULE_DIALOG),this.modalService.show(p.FormsConstants.ROUTES.CREATE_FORM_RULE_DIALOG,this.route)},t.prototype.saveFormRulehandler=function(e,t){var n=this,o=new v.ReplaySubject(1);o.next(new f.ClickResult(!0,!1));var i=e.component.formRule;return i&&(i.Actions.forEach((function(e){e.Action===p.FormsConstants.FORM_ACTION_TYPE.SEND_NOTIFICATION&&(e.Target=e.Target.trim().split("\n").filter((function(e){return e!==c.stringConstants.EMPTY_STRING})).map((function(e){return e.trim()})).join(","))})),t>=0?this.formDefinition.Rules.splice(t,1,i):this.formDefinition.Rules.push(i),this.propagateRules(!1),this.canUpdate=!1,this.formsService.updateRules(this.formDefinition).subscribe((function(e){n.canUpdate=!0,o.next(new f.ClickResult(!0,!0,!1,!1))}))),o},t.prototype.getFormRules=function(){var e=this,t=[];return this.formDefinition.Rules.forEach((function(n){var o=[];n.Conditions.forEach((function(t){e.findFormField(t.Id)&&o.push(t)}));var i=[];n.Actions.forEach((function(t){switch(t.Action){case p.FormsConstants.FORM_ACTION_TYPE.SHOW:case p.FormsConstants.FORM_ACTION_TYPE.HIDE:e.findFormField(t.Target)&&i.push(t);break;case p.FormsConstants.FORM_ACTION_TYPE.SKIP:e.findFormStep(t.Target)&&i.push(t);break;default:i.push(t)}})),o.length>0&&i.length>0&&(n.Conditions=o,n.Actions=i,t.push(n))})),t},t.prototype.findFormField=function(e){return this.formDefinition.Fields.find((function(t){return t.Id===e}))},t.prototype.findFormStep=function(e){return this.formDefinition.Steps.find((function(t){return t.Key===e}))},t.prototype.onNavigateBack=function(){this.document.dispatchEvent(new Event(p.FormsConstants.ROUTES.SITEFINITY_OLD_BACKEND_REFRESH_RULES_EVENT_NAME)),this.router.navigate([I.ROUTE_PATHS.CONTENT,I.ROUTE_PATHS_NO_PREFIX.FORMS,p.FormsConstants.ROUTES.INTEGRATED,this.formDefinition.Name])},t.prototype.propagateRules=function(e){var t=this,n=this.metadataStore.getEntity(E.ENTITY_SET.FORM_DRAFTS),o=[];this.formDefinition.Rules.forEach((function(e){o.push(s.DataItem.from(e,n,null,null))})),this.stateWrapper=r.StateWrapper.wrap({dataItems:o,totalCount:o.length}),e&&(this.canUpdate=!1,this.formsService.updateRules(this.formDefinition).subscribe((function(e){t.canUpdate=!0})))},t.prototype.deleteRule=function(e){var t=this.stateWrapper.dataItems.indexOf(e);t>=0&&this.formDefinition.Rules.splice(t,1),this.propagateRules(!0)},t.prototype.toggleEditFormControlCssClass=function(e){void 0===e&&(e=!0),e?(Object(h.toggleIrisIntegratedStyles)(!0),this.document.body.classList.add(p.FormsConstants.ROUTES.ADMIN_APP_CONTROL_CLASS)):(Object(h.toggleIrisIntegratedStyles)(!1),this.document.body.classList.remove(p.FormsConstants.ROUTES.ADMIN_APP_CONTROL_CLASS))},t.prototype.handleFormRuleFetchError=function(e){throw new Error("An error occurred during fetching the form rules. "+e)},t.ɵfac=function(e){return new(e||t)(i["ɵɵdirectiveInject"](a.FormsService),i["ɵɵdirectiveInject"](d.MetadataStore),i["ɵɵdirectiveInject"](f.ModalWindowService),i["ɵɵdirectiveInject"](m.ActivatedRoute),i["ɵɵdirectiveInject"](m.Router),i["ɵɵdirectiveInject"](C.DOCUMENT_TOKEN),i["ɵɵdirectiveInject"](T.SiteDataStore))},t.ɵcmp=i["ɵɵdefineComponent"]({type:t,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&i["ɵɵviewQuery"](P,3),2&e){var n;i["ɵɵqueryRefresh"](n=i["ɵɵloadQuery"]())&&(t.navigationMenuTemplate=n.first)}},features:[i["ɵɵInheritDefinitionFeature"]],decls:9,vars:3,consts:[["name","dialog"],[1,"sf-wrapper","-list","sf-router-wrapper"],[1,"sf-main","-list"],[3,"configuration","leftNavButtonClick"],["navigationMenuTemplate",""],[4,"ngIf","ngIfElse"],["loading",""],[1,"-sf-ml-xs"],["class","-align-items-center -sf-mt-6xl -sf-txt-align-center ng-star-inserted",4,"ngIf","ngIfElse"],["itemsList",""],[1,"-align-items-center","-sf-mt-6xl","-sf-txt-align-center","ng-star-inserted"],[1,"sf-row__col","-auto-flex"],[1,"-sf-fade-in"],[1,"-sf-mt-6xl","-sf-mb-6xl"],["name","file-text-o","look","illustrative"],["class","-sf-txt-hint -sf-mt-xs",4,"ngIf"],[1,"sf-row__col","-no-flex","-sf-mb-2xs"],["iconlook","size-xs","look","action large sf-mr-zero","icon-look","size-xs",3,"click",4,"ngIf"],[1,"-sf-txt-hint","-sf-mt-xs"],["iconlook","size-xs","look","action large sf-mr-zero","icon-look","size-xs",3,"click"],[1,"sf-row","-sf-mb-m","sf-main__header"],[1,"sf-row__col","-no-flex"],["iconlook","size-xs","look","action","icon-look","size-xs",3,"click"],["look","small inline sf-mb-m"],[1,"-sf-txt-large",3,"itemsState","shouldHideHeader","treeConfig","ignoreLoaderDelay","itemSelectionChanged"],["sfColumnTemplate","","name","if","class","-fluid","clickable","true"],["sfColumnTemplate","","name","condition","class","-fill","clickable","true"],["sfColumnTemplate","","name","then","clickable","true","class","-fluid"],["sfColumnTemplate","","name","result","class","-fill","clickable","true"],["sfColumnTemplate","","name","delete","class","-col-size-3xs -sf-txt-align-right"],[3,"formRuleConditions","formRuleOperator","formDefinition"],[3,"formRuleActions","formDefinition"],["look","size-3xs sf-clickable","name","times",3,"ngClass","click"],[1,"-sf-mt-6xl"],["class","sf-tree-list__row -loading",4,"ngFor","ngForOf"],[1,"sf-tree-list__row","-loading"],[1,"sf-tree-list__cell"],["look","skeleton list"]],template:function(e,t){if(1&e&&(i["ɵɵelement"](0,"router-outlet",0),i["ɵɵelementStart"](1,"div",1),i["ɵɵelementStart"](2,"main",2),i["ɵɵelementStart"](3,"sf-navigation-menu",3),i["ɵɵlistener"]("leftNavButtonClick",(function(){return t.onNavigateBack()})),i["ɵɵelementEnd"](),i["ɵɵtemplate"](4,N,2,0,"ng-template",null,4,i["ɵɵtemplateRefExtractor"]),i["ɵɵtemplate"](6,j,4,2,"ng-container",5),i["ɵɵtemplate"](7,K,2,2,"ng-template",null,6,i["ɵɵtemplateRefExtractor"]),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]()),2&e){var n=i["ɵɵreference"](8);i["ɵɵadvance"](3),i["ɵɵproperty"]("configuration",t.navbarConfiguration),i["ɵɵadvance"](3),i["ɵɵproperty"]("ngIf",t.isInitialRulesLoadComplete)("ngIfElse",n)}},directives:[m.RouterOutlet,l.NavigationMenuComponent,_.NgIf,D.SfIconComponent,D.SfButtonComponent,D.SfNotificationComponent,O.ListComponent,R.ListColumnDirective,A.ConditionColumnComponent,y.ActionColumnComponent,_.NgClass,_.NgForOf,D.SfLoaderComponent],encapsulation:2}),t}(D.SfRxBase)},2519:function(e,t,n){"use strict";n.r(t),n.d(t,"FormsService",(function(){return l}));var o=n(268),i=n(303),r=n(246),s=n(256),a=n(229),l=function(){function e(e,t){this.metadataStore=e,this.dynamicItemsService=t}return e.prototype.getFormDefinition=function(e,t){void 0===t&&(t=r.stringConstants.EMPTY_STRING);var n={itemKey:e,action:"Default.GetTempForm()",entityData:{metadata:this.metadataStore.getEntity(s.ENTITY_SET.FORM_DRAFTS),culture:t}};return this.dynamicItemsService.getItem(n)},e.prototype.updateRules=function(e){var t={metadata:this.metadataStore.getEntity(s.ENTITY_SET.FORM_DRAFTS),provider:r.stringConstants.EMPTY_STRING,culture:e.Culture};return this.dynamicItemsService.executeEntityOperationForDataItemKey(e.Id,t,"Default.SaveTempForm()",{rules:e.Rules})},e.ɵfac=function(t){return new(t||e)(a["ɵɵinject"](o.MetadataStore),a["ɵɵinject"](i.DynamicItemService))},e.ɵprov=a["ɵɵdefineInjectable"]({token:e,factory:e.ɵfac}),e}()},2520:function(e,t,n){"use strict";n.r(t),n.d(t,"FormRuleCreateComponent",(function(){return T}));var o=n(229),i=n(1142),r=n(2521),s=n(246),a=n(2522),l=(n(1117),n(2524)),c=n(368),f=n(1174),u=n(1141),m=n(261),p=n(354),d=n(2525),C=function(e){return{"-sf-mb-xs":e}};function E(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-condition-create-composite",11),o["ɵɵlistener"]("conditionForDelete",(function(e){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().deleteCondition(e)})),o["ɵɵelementEnd"]()}if(2&e){var i=t.$implicit,r=t.last,s=o["ɵɵnextContext"]();o["ɵɵproperty"]("formDefinition",s.formDefinition)("formRuleCondition",i)("canDelete",s.formRule.Conditions.length>1)("ngClass",o["ɵɵpureFunction1"](4,C,!r))}}function h(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-action-create-composite",12),o["ɵɵlistener"]("actionForDelete",(function(e){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().deleteAction(e)})),o["ɵɵelementEnd"]()}if(2&e){var i=t.$implicit,r=t.last,s=o["ɵɵnextContext"]();o["ɵɵproperty"]("formDefinition",s.formDefinition)("formRuleAction",i)("canDelete",s.formRule.Actions.length>1)("ngClass",o["ɵɵpureFunction1"](4,C,!r))}}var T=function(){function e(e,t){this.typeParserService=e,this.scrollService=t}return e.prototype.ngOnInit=function(){this.formRule||(this.formRule={Operator:r.FormRuleOperatorCRUD.Any,Conditions:[this.generateCondition()],Actions:[this.generateAction()]}),this.operatorDropdownSettings=new i.ChoiceSettings("operatorDropdown",!1),this.operatorDropdownSettings.choices=this.generateChoices(),this.formRule&&(this.operatorDropdownSettings.defaultValue=this.formRule.Operator)},e.prototype.canCloseCallback=function(e){var t=!0;return e.data&&e.data.data&&this.actionComponents.forEach((function(e){t=e.isValid()&&t})),t},e.prototype.addCondition=function(){this.formRule.Conditions.push(this.generateCondition())},e.prototype.deleteCondition=function(e){var t=this.formRule.Conditions.indexOf(e);this.formRule.Conditions.splice(t,1)},e.prototype.addAction=function(){this.formRule.Actions.push(this.generateAction())},e.prototype.deleteAction=function(e){var t=this.formRule.Actions.indexOf(e);this.formRule.Actions.splice(t,1)},e.prototype.formOperatorChanged=function(e){this.formRule.Operator=e},e.prototype.generateCondition=function(){var e={Id:s.stringConstants.EMPTY_STRING,Operator:s.stringConstants.EMPTY_STRING,Value:s.stringConstants.EMPTY_STRING},t=this.typeParserService.getConditionFields(this.formDefinition)[0];if(t){e.Id=t.Id;var n=t.Operators[0];n&&(e.Operator=n.Key),e.Value=this.getDefaultFieldValue(t)}return e},e.prototype.generateAction=function(){var e={Action:s.stringConstants.EMPTY_STRING,Target:s.stringConstants.EMPTY_STRING};this.formDefinition.AvailableActions[0]&&(e.Action=this.formDefinition.AvailableActions[0].Key);var t=this.typeParserService.getActionFields(this.formDefinition)[0];return t&&(e.Target=t.Id),e},e.prototype.generateChoices=function(){var e=[];return Object.keys(r.FormRuleOperatorCRUD).forEach((function(t){e.push({Value:r.FormRuleOperatorCRUD[t],Name:t})})),e},e.prototype.getDefaultFieldValue=function(e){var t=s.stringConstants.EMPTY_STRING;return e.Values.length>0&&(t=e.Values[0]),t},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](a.FormFieldTypesParserService),o["ɵɵdirectiveInject"](c.ScrollService))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-form-rule-create"]],viewQuery:function(e,t){if(1&e&&o["ɵɵviewQuery"](l.ActionCreateCompositeComponent,1),2&e){var n;o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.actionComponents=n)}},inputs:{title:"title",formDefinition:"formDefinition",formRule:"formRule"},decls:20,vars:4,consts:[[1,"sf-form","-sf-centered-box"],[3,"heading"],[1,"-sf-txt-align-left"],[1,"sf-field","sf-row","-align-items-center"],[1,"sf-field__label"],[1,"-sf-ml-3xs","-sf-mr-3xs","-sf-txt-large",3,"settings","selectionChange"],[1,"sf-field"],[1,"sf-field__content","-sf-mb-3xs"],["class","-sf-block",3,"formDefinition","formRuleCondition","canDelete","ngClass","conditionForDelete",4,"ngFor","ngForOf"],["look","circle small sf-mb-4xs","icon","plus","iconLook","size-xs",3,"onClick"],["class","-sf-block",3,"formDefinition","formRuleAction","canDelete","ngClass","actionForDelete",4,"ngFor","ngForOf"],[1,"-sf-block",3,"formDefinition","formRuleCondition","canDelete","ngClass","conditionForDelete"],[1,"-sf-block",3,"formDefinition","formRuleAction","canDelete","ngClass","actionForDelete"]],template:function(e,t){1&e&&(o["ɵɵelementStart"](0,"div",0),o["ɵɵelement"](1,"sf-sticky-component",1),o["ɵɵelementStart"](2,"div",2),o["ɵɵelementStart"](3,"div",3),o["ɵɵelementStart"](4,"label",4),o["ɵɵtext"](5,"IF"),o["ɵɵelementEnd"](),o["ɵɵelementStart"](6,"sf-dropdown-choice",5),o["ɵɵlistener"]("selectionChange",(function(e){return t.formOperatorChanged(e)})),o["ɵɵelementEnd"](),o["ɵɵelementStart"](7,"b",4),o["ɵɵtext"](8,"of the following conditions are met"),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementStart"](9,"div",6),o["ɵɵelementStart"](10,"div",7),o["ɵɵtemplate"](11,E,1,6,"sf-condition-create-composite",8),o["ɵɵelementEnd"](),o["ɵɵelementStart"](12,"sf-button",9),o["ɵɵlistener"]("onClick",(function(){return t.addCondition()})),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementStart"](13,"div",6),o["ɵɵelementStart"](14,"label",4),o["ɵɵtext"](15,"THEN..."),o["ɵɵelementEnd"](),o["ɵɵelementStart"](16,"div",7),o["ɵɵtemplate"](17,h,1,6,"sf-action-create-composite",10),o["ɵɵelementEnd"](),o["ɵɵelementStart"](18,"sf-button",9),o["ɵɵlistener"]("onClick",(function(){return t.addAction()})),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelement"](19,"hr"),o["ɵɵelementEnd"]()),2&e&&(o["ɵɵadvance"](1),o["ɵɵproperty"]("heading",t.title),o["ɵɵadvance"](5),o["ɵɵproperty"]("settings",t.operatorDropdownSettings),o["ɵɵadvance"](5),o["ɵɵproperty"]("ngForOf",t.formRule.Conditions),o["ɵɵadvance"](6),o["ɵɵproperty"]("ngForOf",t.formRule.Actions))},directives:[f.StickyComponent,u.ChoiceDropdownComponent,m.NgForOf,p.SfButtonComponent,d.ConditionCreateCompositeComponent,m.NgClass,l.ActionCreateCompositeComponent],encapsulation:2}),e}()},2521:function(e,t,n){"use strict";var o,i;n.r(t),n.d(t,"FormRuleOperatorList",(function(){return o})),n.d(t,"FormRuleOperatorCRUD",(function(){return i})),n.d(t,"FormsConstants",(function(){return r})),function(e){e.Or="or",e.And="and"}(o||(o={})),function(e){e.Any="Or",e.All="And"}(i||(i={}));var r=function(){function e(){}return e.CREATE_A_RULE="Create a rule",e.EDIT_A_RULE="Edit a rule",e.CREATE_THIS_RULE="Create this rule",e.SAVE_THIS_RULE="Save this rule",e.CANCEL="Cancel",e.BACK_TO_FORMS="Back to Forms in Sitefinity",e.MESSAGE="message",e.EMAIL_ADDRESS="email address",e.PAGE="page",e.PAGE_DOES_NOT_EXIST="Selected page does not exist",e.INPUT_PLACEHOLDER="type field value...",e.SELECTED_PAGE_DOES_NOT_EXIST="Selected page doesn't exist anymore.",e.SHOW_HIDE_TOOLTIP_TITLE="Show or hide fields",e.SHOW_HIDE_TOOLTIP_MESSAGE="You can show a field only if it has already been hidden. If you want a form field to be hidden by default when the page loads, you can configure this from the form edit screen.",e.SEND_NOTIFICATION={TEXT_AREA:{INSTRUCTIONAL_TEXT:"Enter email addresses, one per line.",PLACEHOLDER:"email@example.com"}},e.ROUTES={RULES:"rules",INTEGRATED:"integrated",CREATE_FORM_RULE_DIALOG:"CreateFormRule",SITEFINITY_OLD_BACKEND_EDIT_FORM_RULE_EVENT_NAME:"edit-form-rule",SITEFINITY_OLD_BACKEND_REFRESH_RULES_EVENT_NAME:"refresh_form_rules",ADMIN_APP_CONTROL_CLASS:"sfAdminAppControl"},e.STATIC_FORM_FIELDS=["PageBreak","Captcha","SectionHeader","FormNavigation","Hidden","Submit"],e.CONDITION_OPERATORS={Equal:"Equal",NotEqual:"NotEqual",Contains:"Contains",NotContains:"NotContains",IsFilled:"IsFilled",IsNotFilled:"IsNotFilled",IsLessThan:"IsLessThan",IsGreaterThan:"IsGreaterThan",FileSelected:"FileSelected",FileNotSelected:"FileNotSelected"},e.FORM_FIELD_TYPE={TEXTBOX:"Textbox",PARAGRAPH:"Paragraph",MULTIPLE_CHOICE:"MultipleChoice",CHECKBOX:"Checkbox",DROPDOWN:"DropDown",FILE_UPLOAD:"FileUpload"},e.FORM_ACTION_TYPE={SHOW:"Show",HIDE:"Hide",SKIP:"Skip",GOTO:"GoTo",SHOW_MESSAGE:"ShowMessage",SEND_NOTIFICATION:"SendNotification"},e.TEXT_INPUT_TYPE={DATE:"Date",MONTH:"Month",TIME:"Time",DATE_TIME:"DateTime",DATE_TIME_LOCAL:"DateTimeLocal",WEEK:"Week",RANGE:"Range",COLOR:"Color",NUMBER:"Number"},e.TIMEZONE_OFFSET=0,e}()},2522:function(e,t,n){"use strict";n.r(t),n.d(t,"FormFieldTypesParserService",(function(){return R}));var o=n(354),i=n(1141),r=n(1142),s=n(2521),a=n(1236),l=n(1804),c=n(1401),f=n(1696),u=n(1382),m=n(1729),p=n(1116),d=n(333),C=n(331),E=n(1238),h=n(268),T=n(303),g=n(256),F=n(11),S=n(246),I=n(245),v=n(2523),D=n(314),_=n(338),O=n(229),R=function(){function e(e,t){this.metadataStore=e,this.dynamicItemsService=t}return e.prototype.getConditionComponentType=function(e,t){var n=new l.DateTimePickerSettings("dateTimePicker",!1);switch(n.readOnlyMode=!1,e.Type){case s.FormsConstants.FORM_FIELD_TYPE.TEXTBOX:case s.FormsConstants.FORM_FIELD_TYPE.PARAGRAPH:switch(e.InputType){case s.FormsConstants.TEXT_INPUT_TYPE.DATE:return{component:{type:a.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:s.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,showTime:!1,settings:n,value:t}}};case s.FormsConstants.TEXT_INPUT_TYPE.MONTH:return{component:{type:a.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:s.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,dateBottomView:E.DateTimePickerConstants.VIEW.YEAR,dateTopView:E.DateTimePickerConstants.VIEW.DECADE,dateFormat:E.DateTimePickerConstants.MONTH_FORMAT,showTime:!1,settings:n,value:t}}};case s.FormsConstants.TEXT_INPUT_TYPE.TIME:return{component:{type:a.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:s.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,showDate:!1,settings:n,value:t}}};case s.FormsConstants.TEXT_INPUT_TYPE.DATE_TIME:case s.FormsConstants.TEXT_INPUT_TYPE.DATE_TIME_LOCAL:return{component:{type:a.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:s.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,showDate:!0,showTime:!0,settings:n,value:t}}};case s.FormsConstants.TEXT_INPUT_TYPE.RANGE:return{component:{type:o.SfInputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:s.FormsConstants.TEXT_INPUT_TYPE.NUMBER,placeholder:s.FormsConstants.INPUT_PLACEHOLDER}},cssClassList:"sf-row__col"};case s.FormsConstants.TEXT_INPUT_TYPE.COLOR:return{component:{type:o.SfInputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:s.FormsConstants.TEXT_INPUT_TYPE.COLOR,placeholder:s.FormsConstants.INPUT_PLACEHOLDER}},cssClassList:"sf-row__col -col-1"};case s.FormsConstants.TEXT_INPUT_TYPE.WEEK:return{component:{type:o.SfInputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:s.FormsConstants.TEXT_INPUT_TYPE.WEEK,placeholder:s.FormsConstants.INPUT_PLACEHOLDER}}};default:return{component:{type:o.SfInputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:e.InputType,placeholder:s.FormsConstants.INPUT_PLACEHOLDER}},cssClassList:"sf-row__col"}}case s.FormsConstants.FORM_FIELD_TYPE.MULTIPLE_CHOICE:case s.FormsConstants.FORM_FIELD_TYPE.CHECKBOX:case s.FormsConstants.FORM_FIELD_TYPE.DROPDOWN:var f=new r.ChoiceSettings("choiceDropdownComponent",!1);return e.Values.forEach((function(e){f.choices.push({Value:e,Name:e})})),t?f.defaultValue=t:e.Values.length>0&&(f.defaultValue=e.Values[0]),{component:{type:i.ChoiceDropdownComponent,updatePropertiesOnChange:!0,properties:{settings:f}},cssClassList:"sf-row__col"};default:var u=new C.SettingsBase("hiddenComponent",!1);return{component:{type:c.HiddenComponent,properties:{settings:u}},cssClassList:"sf-row__col"}}},e.prototype.getActionComponentType=function(e,t,n){var a,l=this;switch(e){case s.FormsConstants.FORM_ACTION_TYPE.SHOW:case s.FormsConstants.FORM_ACTION_TYPE.HIDE:var c=new r.ChoiceSettings("formTargetDropdown",!1);return this.getActionFields(t).forEach((function(e){c.choices.push({Value:e.Id,Name:e.Title})})),n?c.defaultValue=n:t.Fields.length>0&&(c.defaultValue=t.Fields[0].Id),a={component:{type:i.ChoiceDropdownComponent,updatePropertiesOnChange:!0,properties:{settings:c}},tooltip:{title:s.FormsConstants.SHOW_HIDE_TOOLTIP_TITLE,message:s.FormsConstants.SHOW_HIDE_TOOLTIP_MESSAGE}},Object(F.of)(a);case s.FormsConstants.FORM_ACTION_TYPE.SKIP:var C=new r.ChoiceSettings("formActionsDropdown",!1);return t.Steps.forEach((function(e){C.choices.push({Value:e.Key,Name:e.Value})})),n?C.defaultValue=n:t.Steps.length>0&&(C.defaultValue=t.Steps[0].Key),a={component:{type:i.ChoiceDropdownComponent,updatePropertiesOnChange:!0,properties:{settings:C}}},Object(F.of)(a);case s.FormsConstants.FORM_ACTION_TYPE.SHOW_MESSAGE:var E=void 0,h=new f.TextAreaSettings("editorComponent",!1);h.required=!0,h.friendlyTitle=s.FormsConstants.MESSAGE;var T=[];return T.push(D.Validators.required),h.validators=D.Validators.compose(T),n?E=n:h.defaultValue=S.stringConstants.EMPTY_STRING,a={component:{type:u.TextAreaComponent,updatePropertiesOnChange:!0,properties:{settings:h,value:E}},cssClassList:"sf-row__col"},Object(F.of)(a);case s.FormsConstants.FORM_ACTION_TYPE.SEND_NOTIFICATION:var O=void 0,R=new v.TextAreaMultilineEmailSettings("editorComponent",!1);R.required=!0,R.friendlyTitle=s.FormsConstants.EMAIL_ADDRESS,R.instructionalText=s.FormsConstants.SEND_NOTIFICATION.TEXT_AREA.INSTRUCTIONAL_TEXT,R.placeholder=s.FormsConstants.SEND_NOTIFICATION.TEXT_AREA.PLACEHOLDER;var A=[];return A.push(D.Validators.required),A.push(_.VALIDATORS[_.VALIDATOR_NAMES.MULTILINE_EMAILS]()),R.validators=D.Validators.compose(A),n?O=n.split(",").join("\n"):R.defaultValue=S.stringConstants.EMPTY_STRING,a={component:{type:u.TextAreaComponent,updatePropertiesOnChange:!0,properties:{settings:R,value:O}},cssClassList:"sf-row__col"},Object(F.of)(a);case s.FormsConstants.FORM_ACTION_TYPE.GOTO:var y=new m.RelatedDataSettings("relatedDataComponent",!1);y.type=g.ENTITY_SET.PAGES,y.culture=t.Culture,y.allowMultiple=!1,y.displayMode=d.DISPLAY_MODE.INPUT,y.required=!0,y.title=s.FormsConstants.PAGE;var P=[];if(P.push(D.Validators.required),y.validators=D.Validators.compose(P),n){var N={itemKey:n,entityData:{metadata:this.metadataStore.getEntity(g.ENTITY_SET.PAGES),culture:t.Culture}};return new F.Observable((function(e){l.dynamicItemsService.getItem(N).subscribe((function(t){e.next(a={component:{type:p.RelatedDataComponent,updatePropertiesOnChange:!0,properties:{settings:y,value:[Object(I.cloneObject)(t.data)]}},cssClassList:"sf-row__col"})}),(function(t){e.next(a={component:{type:p.RelatedDataComponent,updatePropertiesOnChange:!0,properties:{settings:y,value:[Object(I.cloneObject)({Title:s.FormsConstants.SELECTED_PAGE_DOES_NOT_EXIST,NotFound:!0,icon:"ban",iconLook:"darker",inactive:!0})]}},cssClassList:"sf-row__col"})}))}))}return a={component:{type:p.RelatedDataComponent,updatePropertiesOnChange:!0,properties:{settings:y,value:[]}},cssClassList:"sf-row__col"},Object(F.of)(a);default:return a={component:{type:o.SfInputComponent}},Object(F.of)(a)}},e.prototype.getField=function(e,t){return e.Fields.find((function(e){return e.Id===t}))},e.prototype.getConditionFields=function(e){var t=[];return e.Fields.forEach((function(e){e.Type&&e.Operators&&e.Operators.length>0&&-1===s.FormsConstants.STATIC_FORM_FIELDS.indexOf(e.Type)&&t.push(e)})),t},e.prototype.getActionFields=function(e){var t=[];return e.Fields.forEach((function(e){e.Hideable&&t.push(e)})),t},e.ɵfac=function(t){return new(t||e)(O["ɵɵinject"](h.MetadataStore),O["ɵɵinject"](T.DynamicItemService))},e.ɵprov=O["ɵɵdefineInjectable"]({token:e,factory:e.ɵfac}),e}()},2523:function(e,t,n){"use strict";n.r(t),n.d(t,"TextAreaMultilineEmailSettings",(function(){return r}));var o=n(259),i=n(338),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.getValidators=function(t){var n=e.prototype.getValidators.call(this,t);return n.push(i.VALIDATORS[i.VALIDATOR_NAMES.MULTILINE_EMAILS]()),n},t}(n(1696).TextAreaSettings)},2524:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionCreateCompositeComponent",(function(){return g}));var o=n(259),i=n(229),r=n(1142),s=n(2522),a=n(131),l=n(314),c=n(354),f=n(1141),u=n(261),m=["loader"];function p(e,t){if(1&e&&(i["ɵɵelementStart"](0,"div",11),i["ɵɵtext"](1),i["ɵɵelementEnd"]()),2&e){var n=i["ɵɵnextContext"](2);i["ɵɵadvance"](1),i["ɵɵtextInterpolate1"](" ",n.formFieldColumnData.component.properties.settings.instructionalText," ")}}function d(e,t){if(1&e&&i["ɵɵelement"](0,"sf-error",12),2&e){var n=i["ɵɵnextContext"](2);i["ɵɵproperty"]("messages",n.errorMessages)}}var C=function(e){return{"-has-errors":e}};function E(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"div",6),i["ɵɵelementStart"](1,"sf-component-loader",7,8),i["ɵɵlistener"]("componentInit",(function(e){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().loaderInit(e)})),i["ɵɵelementEnd"](),i["ɵɵtemplate"](3,p,2,1,"div",9),i["ɵɵtemplate"](4,d,1,1,"sf-error",10),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"]();i["ɵɵproperty"]("ngClass",o.formFieldColumnData.cssClassList),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngClass",i["ɵɵpureFunction1"](5,C,o.showErrors&&o.errorMessages&&o.errorMessages.length>0))("componentData",o.formFieldColumnData.component),i["ɵɵadvance"](2),i["ɵɵproperty"]("ngIf",o.formFieldColumnData.component.properties.settings.instructionalText&&(!o.showErrors||!o.errorMessages||0===o.errorMessages.length)),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",o.showErrors&&o.errorMessages&&o.errorMessages.length>0)}}function h(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"span",13),i["ɵɵelementStart"](1,"sf-icon",14),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().onToggleTooltip()}))("keyup.enter",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().onToggleTooltip()})),i["ɵɵelementEnd"](),i["ɵɵelementStart"](2,"sf-notification",15),i["ɵɵtext"](3),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"]();i["ɵɵclassProp"]("-dropped",o.droppedTooltip),i["ɵɵadvance"](2),i["ɵɵproperty"]("caption",o.formFieldColumnData.tooltip.title),i["ɵɵadvance"](1),i["ɵɵtextInterpolate1"](" ",o.formFieldColumnData.tooltip.message," ")}}function T(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"sf-icon",16),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().deleteAction()})),i["ɵɵelementEnd"]()}}var g=function(e){function t(t){var n=e.call(this)||this;return n.typeParserService=t,n.actionForDelete=new i.EventEmitter,n.showErrors=!1,n.formGroup=new l.FormGroup({}),n}return Object(o.__extends)(t,e),t.prototype.ngOnInit=function(){this.initActionFields()},t.prototype.loaderInit=function(e){var t=this,n=this;this.wrappedField=e,this.handleFocusChanges(),this.wrappedField.registerOnChange((function(e){t.processErrors(),e instanceof Array&&e.length>0?n.formRuleAction.Target=e[0].Id:n.formRuleAction.Target=e}))},t.prototype.formActionChanged=function(e){e&&(this.formRuleAction.Action=e,this.refreshDynamicComponent(null))},t.prototype.deleteAction=function(){this.actionForDelete.emit(this.formRuleAction)},t.prototype.isValid=function(){var e;this.formGroup.reset(),this.formGroup.setControl(this.wrappedField.settings.key,new l.FormControl(this.wrappedField.value,{validators:this.wrappedField.settings.validators})),this.formGroup.updateValueAndValidity(),e=this.formGroup.valid;var t=this.wrappedField.processErrors(this.formGroup.controls[this.wrappedField.settings.key].errors);return this.processErrors(t),e},t.prototype.processErrors=function(e){void 0===e&&(e=[]),this.errorMessages=[],this.showErrors=!1,e&&e.length>0&&(this.errorMessages=e,this.showErrors=!0)},t.prototype.onToggleTooltip=function(){this.droppedTooltip=!this.droppedTooltip},t.prototype.handleFocusChanges=function(){var e=this,t=this.wrappedField.focus$.subscribe((function(t){e.showErrors=!t}));this.registerSubscription(t)},t.prototype.initActionFields=function(){var e=this;this.formRuleAction&&(this.formActionsDropdownSettings=new r.ChoiceSettings("formActionsDropdown",!1),this.formDefinition.AvailableActions.forEach((function(t){e.formActionsDropdownSettings.choices.push({Value:t.Key,Name:t.Value})})),this.formActionsDropdownSettings.defaultValue=this.formRuleAction.Action,this.refreshDynamicComponent(this.formRuleAction.Target))},t.prototype.refreshDynamicComponent=function(e){var t=this;this.processErrors(),this.loader&&this.loader.destroy(this.formFieldColumnData.component),this.typeParserService.getActionComponentType(this.formRuleAction.Action,this.formDefinition,e).pipe(Object(a.first)()).subscribe((function(e){t.formFieldColumnData=e;var n=t.formFieldColumnData.component.properties.settings.defaultValue;null!==n&&(t.formRuleAction.Target=n.toString())}))},t.ɵfac=function(e){return new(e||t)(i["ɵɵdirectiveInject"](s.FormFieldTypesParserService))},t.ɵcmp=i["ɵɵdefineComponent"]({type:t,selectors:[["sf-action-create-composite"]],viewQuery:function(e,t){if(1&e&&i["ɵɵviewQuery"](m,1),2&e){var n;i["ɵɵqueryRefresh"](n=i["ɵɵloadQuery"]())&&(t.loader=n.first)}},inputs:{formDefinition:"formDefinition",formRuleAction:"formRuleAction",canDelete:"canDelete"},outputs:{actionForDelete:"actionForDelete"},features:[i["ɵɵInheritDefinitionFeature"]],decls:6,vars:4,consts:[[1,"sf-row"],[1,"sf-row__col","-col-6","-sf-mr-xs"],[3,"settings","selectionChange"],["class","-sf-mr-3xs",3,"ngClass",4,"ngIf"],["class","-align-self-center sf-field__tooltip sf-tooltip -open-on-click",3,"-dropped",4,"ngIf"],["look","size-3xs sf-clickable","name","times","class","-sf-mt-3xs -sf-ml-auto",3,"click",4,"ngIf"],[1,"-sf-mr-3xs",3,"ngClass"],[1,"sf-field","-sf-mb-zero","-sf-pb-zero","-sf-pt-zero",3,"ngClass","componentData","componentInit"],["loader",""],["class","sf-field__hint -sf-mt-4xs -sf-txt-base",4,"ngIf"],["class","-sf-mt-4xs -sf-txt-base",3,"messages",4,"ngIf"],[1,"sf-field__hint","-sf-mt-4xs","-sf-txt-base"],[1,"-sf-mt-4xs","-sf-txt-base",3,"messages"],[1,"-align-self-center","sf-field__tooltip","sf-tooltip","-open-on-click"],["name","question-circle","look","size-xs sf-clickable","tabindex","0","aria-label","Show or hide fields information",3,"click","keyup.enter"],["look","tooltip narrow",1,"sf-tooltip__content",3,"caption"],["look","size-3xs sf-clickable","name","times",1,"-sf-mt-3xs","-sf-ml-auto",3,"click"]],template:function(e,t){1&e&&(i["ɵɵelementStart"](0,"div",0),i["ɵɵelementStart"](1,"div",1),i["ɵɵelementStart"](2,"sf-dropdown-choice",2),i["ɵɵlistener"]("selectionChange",(function(e){return t.formActionChanged(e)})),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵtemplate"](3,E,5,7,"div",3),i["ɵɵtemplate"](4,h,4,4,"span",4),i["ɵɵtemplate"](5,T,1,0,"sf-icon",5),i["ɵɵelementEnd"]()),2&e&&(i["ɵɵadvance"](2),i["ɵɵproperty"]("settings",t.formActionsDropdownSettings),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",t.formFieldColumnData),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",t.formFieldColumnData&&t.formFieldColumnData.tooltip),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",t.canDelete))},directives:[f.ChoiceDropdownComponent,u.NgIf,u.NgClass,c.SfDynamicComponentLoaderComponent,c.SfErrorComponent,c.SfIconComponent,c.SfNotificationComponent],encapsulation:2}),t}(c.SfRxBase)},2525:function(e,t,n){"use strict";n.r(t),n.d(t,"ConditionCreateCompositeComponent",(function(){return E}));var o=n(229),i=n(1142),r=n(2521),s=n(2522),a=n(246),l=n(1236),c=n(245),f=n(354),u=n(1141),m=n(261),p=["loader"];function d(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-component-loader",6,7),o["ɵɵlistener"]("componentInit",(function(e){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().loaderInit(e)})),o["ɵɵelementEnd"]()}if(2&e){var i=o["ɵɵnextContext"]();o["ɵɵproperty"]("componentData",i.formFieldColumnData.component)("ngClass",i.formFieldColumnData.cssClassList)}}function C(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-icon",8),o["ɵɵlistener"]("click",(function(){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().deleteCondition()})),o["ɵɵelementEnd"]()}}var E=function(){function e(e){this.typeParserService=e,this.conditionForDelete=new o.EventEmitter}return e.prototype.ngOnInit=function(){this.initConditionFields()},e.prototype.formFieldChanged=function(e){if(this.formField=this.formDefinition.Fields.find((function(t){return t.Id===e})),this.formField){var t=this.formField.Operators.length>0?this.formField.Operators[0].Key:null;this.operatorsDropdownSettings.choices=this.setOperatorChoices(this.formField.Operators),this.operatorsDropdownSettings.defaultValue=t,this.formRuleCondition.Operator=t,this.formRuleCondition.Value=this.getDefaultFieldValue(),this.refreshDynamicComponent(this.formField,t,this.formRuleCondition.Value)}this.formRuleCondition.Id=e},e.prototype.conditionOperatorChanged=function(e){this.refreshDynamicComponent(this.formField,e,this.formRuleCondition.Value),this.formRuleCondition.Operator=e},e.prototype.deleteCondition=function(){this.conditionForDelete.emit(this.formRuleCondition)},e.prototype.loaderInit=function(e){var t=this;this.wrappedField=e,this.wrappedField.registerOnChange((function(e){if(t.loader.currentInstance instanceof l.DateTimePickerComponent)if(e){var n=new Date(e);t.formRuleCondition.Value=Object(c.convertDateToIsoDateTime)(n,r.FormsConstants.TIMEZONE_OFFSET)}else t.formRuleCondition.Value=e;else t.formRuleCondition.Value=e}))},e.prototype.initConditionFields=function(){var e=this;this.formRuleCondition&&(this.formFieldsDropdownSettings=new i.ChoiceSettings("formFieldsDropdown",!1),this.operatorsDropdownSettings=new i.ChoiceSettings("operatorsDropdown",!1),this.typeParserService.getConditionFields(this.formDefinition).forEach((function(t){e.formFieldsDropdownSettings.choices.push({Value:t.Id,Name:t.Title})})),this.formField=this.formDefinition.Fields.find((function(t){return t.Id===e.formRuleCondition.Id})),this.formField&&(this.formFieldsDropdownSettings.defaultValue=this.formRuleCondition.Id,this.operatorsDropdownSettings.choices=this.setOperatorChoices(this.formField.Operators),this.operatorsDropdownSettings.defaultValue=this.formRuleCondition.Operator,this.refreshDynamicComponent(this.formField,this.formRuleCondition.Operator,this.formRuleCondition.Value)))},e.prototype.refreshDynamicComponent=function(e,t,n){this.loader&&this.loader.destroy(this.formFieldColumnData.component),t===r.FormsConstants.CONDITION_OPERATORS.IsFilled||t===r.FormsConstants.CONDITION_OPERATORS.IsNotFilled?(this.formRuleCondition.Value=a.stringConstants.EMPTY_STRING,this.formFieldColumnData=this.typeParserService.getConditionComponentType({Type:null},null)):this.formFieldColumnData=this.typeParserService.getConditionComponentType(e,n)},e.prototype.setOperatorChoices=function(e){return e.map((function(e){return{Name:e.Value,Value:e.Key}}))},e.prototype.getDefaultFieldValue=function(){var e=a.stringConstants.EMPTY_STRING;return this.formField&&this.formField.Values&&this.formField.Values.length>0&&(e=this.formField.Values[0]),e},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](s.FormFieldTypesParserService))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-condition-create-composite"]],viewQuery:function(e,t){if(1&e&&o["ɵɵviewQuery"](p,1),2&e){var n;o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.loader=n.first)}},inputs:{formDefinition:"formDefinition",formRuleCondition:"formRuleCondition",canDelete:"canDelete"},outputs:{conditionForDelete:"conditionForDelete"},decls:7,vars:4,consts:[[1,"sf-row"],[1,"sf-row__col","-col-6","-sf-mr-xs"],[1,"-sf-mr-xs","sf-row__col","-col-7",3,"settings","selectionChange"],[1,"sf-row__col",3,"settings","selectionChange"],["class","-sf-mr-3xs",3,"componentData","ngClass","componentInit",4,"ngIf"],["look","size-3xs sf-clickable","name","times","class","-sf-mt-3xs  -sf-ml-auto",3,"click",4,"ngIf"],[1,"-sf-mr-3xs",3,"componentData","ngClass","componentInit"],["loader",""],["look","size-3xs sf-clickable","name","times",1,"-sf-mt-3xs","-sf-ml-auto",3,"click"]],template:function(e,t){1&e&&(o["ɵɵelementStart"](0,"div",0),o["ɵɵelementStart"](1,"div",1),o["ɵɵelementStart"](2,"div",0),o["ɵɵelementStart"](3,"sf-dropdown-choice",2),o["ɵɵlistener"]("selectionChange",(function(e){return t.formFieldChanged(e)})),o["ɵɵelementEnd"](),o["ɵɵelementStart"](4,"sf-dropdown-choice",3),o["ɵɵlistener"]("selectionChange",(function(e){return t.conditionOperatorChanged(e)})),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵtemplate"](5,d,2,2,"sf-component-loader",4),o["ɵɵtemplate"](6,C,1,0,"sf-icon",5),o["ɵɵelementEnd"]()),2&e&&(o["ɵɵadvance"](3),o["ɵɵproperty"]("settings",t.formFieldsDropdownSettings),o["ɵɵadvance"](1),o["ɵɵproperty"]("settings",t.operatorsDropdownSettings),o["ɵɵadvance"](1),o["ɵɵproperty"]("ngIf",t.formFieldColumnData),o["ɵɵadvance"](1),o["ɵɵproperty"]("ngIf",t.canDelete))},directives:[u.ChoiceDropdownComponent,m.NgIf,f.SfDynamicComponentLoaderComponent,m.NgClass,f.SfIconComponent],encapsulation:2}),e}()},2526:function(e,t,n){"use strict";n.r(t),n.d(t,"ConditionColumnComponent",(function(){return m})),n.d(t,"GetConditionFieldTitlePipe",(function(){return p})),n.d(t,"GetConditionOperatorLabelPipe",(function(){return d})),n.d(t,"GetRuleOperatorLabelPipe",(function(){return C})),n.d(t,"GetConditionFieldValuePipe",(function(){return E}));var o=n(2521),i=n(2522),r=n(246),s=n(1104),a=n(1431),l=n(229),c=n(261);function f(e,t){if(1&e&&(l["ɵɵelementStart"](0,"span",1),l["ɵɵtext"](1),l["ɵɵpipe"](2,"sfGetRuleOperatorLabel"),l["ɵɵelementEnd"]()),2&e){var n=l["ɵɵnextContext"](2);l["ɵɵadvance"](1),l["ɵɵtextInterpolate1"](" ",l["ɵɵpipeBind1"](2,1,n.formRuleOperator),"")}}function u(e,t){if(1&e&&(l["ɵɵelementStart"](0,"div"),l["ɵɵelementStart"](1,"div"),l["ɵɵtext"](2),l["ɵɵpipe"](3,"sfGetConditionFieldTitle"),l["ɵɵelementStart"](4,"span",1),l["ɵɵtext"](5),l["ɵɵpipe"](6,"sfGetConditionOperatorLabel"),l["ɵɵelementEnd"](),l["ɵɵtext"](7),l["ɵɵpipe"](8,"sfGetConditionFieldValue"),l["ɵɵtemplate"](9,f,3,3,"span",2),l["ɵɵelementEnd"](),l["ɵɵelementEnd"]()),2&e){var n=t.$implicit,o=t.last,i=l["ɵɵnextContext"]();l["ɵɵadvance"](2),l["ɵɵtextInterpolate"](l["ɵɵpipeBind2"](3,4,n,i.formDefinition)),l["ɵɵadvance"](3),l["ɵɵtextInterpolate1"](" ",l["ɵɵpipeBind2"](6,7,n,i.formDefinition)," "),l["ɵɵadvance"](2),l["ɵɵtextInterpolate"](l["ɵɵpipeBind2"](8,10,n,i.formDefinition)),l["ɵɵadvance"](2),l["ɵɵproperty"]("ngIf",!o)}}var m=function(){function e(e){this.typeParserService=e}return e.ɵfac=function(t){return new(t||e)(l["ɵɵdirectiveInject"](i.FormFieldTypesParserService))},e.ɵcmp=l["ɵɵdefineComponent"]({type:e,selectors:[["sf-condition-column"]],inputs:{formRuleConditions:"formRuleConditions",formRuleOperator:"formRuleOperator",formDefinition:"formDefinition"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"-sf-txt-hint"],["class","-sf-txt-hint",4,"ngIf"]],template:function(e,t){1&e&&l["ɵɵtemplate"](0,u,10,13,"div",0),2&e&&l["ɵɵproperty"]("ngForOf",t.formRuleConditions)},directives:function(){return[c.NgForOf,c.NgIf]},pipes:function(){return[p,d,E,C]},encapsulation:2}),e}(),p=function(){function e(e){this.typeParserService=e}return e.prototype.transform=function(e,t){var n=this.typeParserService.getField(t,e.Id);return n?n.Title:r.stringConstants.EMPTY_STRING},e.ɵfac=function(t){return new(t||e)(l["ɵɵdirectiveInject"](i.FormFieldTypesParserService))},e.ɵpipe=l["ɵɵdefinePipe"]({name:"sfGetConditionFieldTitle",type:e,pure:!0}),e}(),d=function(){function e(e){this.typeParserService=e}return e.prototype.transform=function(e,t){var n=this.typeParserService.getField(t,e.Id);if(n){var o=n.Operators.find((function(t){return t.Key===e.Operator}));if(o)return o.Value}return r.stringConstants.EMPTY_STRING},e.ɵfac=function(t){return new(t||e)(l["ɵɵdirectiveInject"](i.FormFieldTypesParserService))},e.ɵpipe=l["ɵɵdefinePipe"]({name:"sfGetConditionOperatorLabel",type:e,pure:!0}),e}(),C=function(){function e(){}return e.prototype.transform=function(e){return o.FormRuleOperatorList[e]},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=l["ɵɵdefinePipe"]({name:"sfGetRuleOperatorLabel",type:e,pure:!0}),e}(),E=function(){function e(e){this.typeParserService=e,this.relativeDatePipe=new s.RelativeDatePipe,this.isoWeekDatesPipe=new a.IsoWeekDatesPipe}return e.prototype.transform=function(e,t){var n=this.typeParserService.getField(t,e.Id);if(n&&n.InputType&&e.Value&&e.Value.trim()!==r.stringConstants.EMPTY_STRING)switch(n.InputType){case o.FormsConstants.TEXT_INPUT_TYPE.DATE:return this.relativeDatePipe.transform(e.Value,null,o.FormsConstants.TIMEZONE_OFFSET);case o.FormsConstants.TEXT_INPUT_TYPE.MONTH:return this.relativeDatePipe.transform(e.Value,s.RelativeDatePipe.MONTH_AND_YEAR,o.FormsConstants.TIMEZONE_OFFSET);case o.FormsConstants.TEXT_INPUT_TYPE.TIME:return this.relativeDatePipe.transform(e.Value,s.RelativeDatePipe.TIME,o.FormsConstants.TIMEZONE_OFFSET);case o.FormsConstants.TEXT_INPUT_TYPE.DATE_TIME_LOCAL:return this.relativeDatePipe.transform(e.Value,s.RelativeDatePipe.FULL_DATE_SHORT_MONTH_AND_TIME,o.FormsConstants.TIMEZONE_OFFSET);case o.FormsConstants.TEXT_INPUT_TYPE.WEEK:return this.isoWeekDatesPipe.transform(e.Value);default:return e.Value}return e.Value},e.ɵfac=function(t){return new(t||e)(l["ɵɵdirectiveInject"](i.FormFieldTypesParserService))},e.ɵpipe=l["ɵɵdefinePipe"]({name:"sfGetConditionFieldValue",type:e,pure:!0}),e}()},2527:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionColumnComponent",(function(){return c}));var o=n(229),i=n(261),r=n(2528),s=n(359),a=n(2529);function l(e,t){if(1&e&&(o["ɵɵelementStart"](0,"div"),o["ɵɵelementStart"](1,"span",1,2),o["ɵɵtext"](3),o["ɵɵpipe"](4,"sfTrimText"),o["ɵɵelementEnd"](),o["ɵɵelementStart"](5,"span",3,4),o["ɵɵtext"](7),o["ɵɵelementEnd"](),o["ɵɵelementEnd"]()),2&e){var n=t.$implicit,i=o["ɵɵreference"](2),r=o["ɵɵreference"](6),s=o["ɵɵnextContext"]();o["ɵɵadvance"](1),o["ɵɵproperty"]("formRuleAction",n)("formDefinition",s.formDefinition)("isFormField",!1),o["ɵɵadvance"](2),o["ɵɵtextInterpolate1"](" ",o["ɵɵpipeBind2"](4,9,i.actionColumnData.title,"...")," "),o["ɵɵadvance"](2),o["ɵɵproperty"]("formRuleAction",n)("formDefinition",s.formDefinition)("ngClass",r.actionColumnData.cssClassList)("trimLength",50),o["ɵɵadvance"](2),o["ɵɵtextInterpolate1"](" ",r.actionColumnData.title," ")}}var c=function(){function e(){}return e.ɵfac=function(t){return new(t||e)},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-action-column"]],inputs:{formRuleActions:"formRuleActions",formDefinition:"formDefinition"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["sfFormActionColumn","",1,"-sf-txt-hint",3,"formRuleAction","formDefinition","isFormField"],["formActionColumn","sfFormActionColumn"],["sfFormActionColumn","","sfTextOverflow","",3,"formRuleAction","formDefinition","ngClass","trimLength"],["formFieldActionColumn","sfFormActionColumn"]],template:function(e,t){1&e&&o["ɵɵtemplate"](0,l,8,12,"div",0),2&e&&o["ɵɵproperty"]("ngForOf",t.formRuleActions)},directives:[i.NgForOf,r.FormActionColumnDirective,s.TextOverflowDirective,i.NgClass],pipes:[a.TrimTextPipe],encapsulation:2}),e}()},2528:function(e,t,n){"use strict";n.r(t),n.d(t,"FormActionColumnDirective",(function(){return f}));var o=n(2521),i=n(2522),r=n(246),s=n(268),a=n(303),l=n(256),c=n(229),f=function(){function e(e,t,n){this.typeParserService=e,this.metadataStore=t,this.dynamicItemsService=n,this.isFormField=!0,this.actionColumnData={title:r.stringConstants.EMPTY_STRING}}return e.prototype.ngOnInit=function(){this.setFieldActionData()},e.prototype.setFieldActionData=function(){this.isFormField?this.getActionFieldData():this.getActionData()},e.prototype.getActionData=function(){var e=this,t=this.formDefinition.AvailableActions.find((function(t){return t.Key===e.formRuleAction.Action}));this.actionColumnData.title=this.formRuleAction.Action,t&&(this.actionColumnData.title=t.Value)},e.prototype.getActionFieldData=function(){var e=this;switch(this.formRuleAction.Action){case o.FormsConstants.FORM_ACTION_TYPE.SHOW:case o.FormsConstants.FORM_ACTION_TYPE.HIDE:var t=this.typeParserService.getField(this.formDefinition,this.formRuleAction.Target);t&&(this.actionColumnData.title=t.Title);break;case o.FormsConstants.FORM_ACTION_TYPE.SKIP:var n=this.formDefinition.Steps?this.formDefinition.Steps.find((function(t){return t.Key.toString()===e.formRuleAction.Target})):null;n&&(this.actionColumnData.title=n.Value);break;case o.FormsConstants.FORM_ACTION_TYPE.GOTO:var i=this.formRuleAction.Target;if(i){var s={itemKey:i,entityData:{metadata:this.metadataStore.getEntity(l.ENTITY_SET.PAGES),culture:this.formDefinition.Culture}};this.dynamicItemsService.getItem(s).subscribe((function(t){e.actionColumnData.title=t.data.Title}),(function(t){e.actionColumnData={title:o.FormsConstants.PAGE_DOES_NOT_EXIST,cssClassList:"-sf-txt-failure"}}))}break;case o.FormsConstants.FORM_ACTION_TYPE.SEND_NOTIFICATION:this.actionColumnData.title=this.formRuleAction.Target.trim().split(",").filter((function(e){return e!==r.stringConstants.EMPTY_STRING})).map((function(e){return e.trim()})).join(""+r.stringConstants.COMMA+r.stringConstants.INTERVAL);break;default:this.actionColumnData.title=this.formRuleAction.Target}},e.ɵfac=function(t){return new(t||e)(c["ɵɵdirectiveInject"](i.FormFieldTypesParserService),c["ɵɵdirectiveInject"](s.MetadataStore),c["ɵɵdirectiveInject"](a.DynamicItemService))},e.ɵdir=c["ɵɵdefineDirective"]({type:e,selectors:[["","sfFormActionColumn",""]],inputs:{formRuleAction:"formRuleAction",formDefinition:"formDefinition",isFormField:"isFormField"},exportAs:["sfFormActionColumn"]}),e}()},2529:function(e,t,n){"use strict";n.r(t),n.d(t,"TrimTextPipe",(function(){return r}));var o=n(246),i=n(229),r=function(){function e(){}return e.prototype.transform=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return o.stringConstants.EMPTY_STRING;var i=e,r=t[0]?t[0].trim():o.stringConstants.EMPTY_STRING;return r&&r!==o.stringConstants.EMPTY_STRING&&(r=r.replace(o.regexConstants.ESCAPE_RESERVED_CHARACTERS_PATTERN,"\\"+o.regexConstants.DOLLAR+o.stringConstants.AMPERSAND),i=(i=i.replace(new RegExp(o.regexConstants.CARET+r,o.regexConstants.IGNORE_CASE),o.stringConstants.EMPTY_STRING)).replace(new RegExp(r+o.regexConstants.DOLLAR,o.regexConstants.IGNORE_CASE),o.stringConstants.EMPTY_STRING)),i},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=i["ɵɵdefinePipe"]({name:"sfTrimText",type:e,pure:!0}),e}()},2530:function(e,t,n){"use strict";n.r(t),n.d(t,"FormsEditIntegratedComponent",(function(){return l}));var o=n(261),i=n(260),r=n(2521),s=n(1151),a=n(229),l=function(){function e(e,t){this.document=e,this.router=t}return e.prototype.ngOnInit=function(){var e=this;this.document.addEventListener(r.FormsConstants.ROUTES.SITEFINITY_OLD_BACKEND_EDIT_FORM_RULE_EVENT_NAME,(function(t){e.formId=t.detail.controlId,e.culture=t.detail.culture,e.router.navigate([s.ROUTE_PATHS.CONTENT,s.ROUTE_PATHS_NO_PREFIX.FORMS,r.FormsConstants.ROUTES.RULES],{queryParams:{id:e.formId,culture:e.culture}})}))},e.ɵfac=function(t){return new(t||e)(a["ɵɵdirectiveInject"](o.DOCUMENT),a["ɵɵdirectiveInject"](i.Router))},e.ɵcmp=a["ɵɵdefineComponent"]({type:e,selectors:[["sf-forms-edit-integrated"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}()}}]);